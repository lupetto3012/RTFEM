import{T as c,r as m,o as i,c as f,w as v,a as s,n as h,b as g,v as b,d as n,t as u,e as d,f as D,F as w,g as y,h as k}from"./app-cbaab5f1.js";import{_ as C,L as _}from"./Layout-4b390331.js";const x={components:{Layout:_},data(){return{form:c({log:null,highlights:[]}),random:null,showModal:!1,uploading:!1,uploadProgress:0,isDragging:!1,saveHint:null}},methods:{init(){},submit(){this.form.put("/",{onSuccess:o=>{this.random=o.props.random,this.showModal=!0,this.reset()},onError:()=>{alert("Error...")}})},selectHighlight(){const o=this.$refs.log,e=this.form.log.slice(o.selectionStart,o.selectionEnd);this.form.highlights.includes(e)||this.form.highlights.push(e)},copyToClipboard(){copyToClipboard(this.viewUrl)},clearHighlights(){window.getSelection().removeAllRanges(),this.form.highlights=[]},handleTextareaChange(){(!this.form.log||this.form.log.length===0)&&this.clearHighlights()},reset(){this.form.reset()},handleFileDrop(o){o.preventDefault(),this.isDragging=!1;for(const e of o.dataTransfer.files){this.ocr(e);break}},ocr(o){this.uploading=!0;let e=new FormData;e.append(o.name,o),e.append("apikey","K88732543888957"),e.append("isTable","true"),axios.post("https://api.ocr.space/parse/image",e,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:a=>{this.uploadProgress=Math.ceil(a.loaded/a.total*100/5)*5}}).then(a=>{this.form.log=a.data.ParsedResults[0].ParsedText.replaceAll(/\t/gm,"").replaceAll(/\r/gm,"");debugger}).catch(a=>{alert("Error during OCR processing...")}).finally(a=>{this.uploading=!1})},handleFileDragOver(o){o.preventDefault(),this.isDragging=!0},handleFileDragLeave(o){o.preventDefault(),this.isDragging=!1}},computed:{viewUrl(){return window.location+this.random},dropClass(){return this.isDragging?"border-success":""}},mounted(){this.init(),emitter.on("keypress-ctrl-s",o=>{o.preventDefault(),this.submit()}),document.onpaste=o=>{const a=(o.clipboardData||window.clipboardData).files[0];a!==void 0&&this.ocr(a)}},watch:{}},T={class:"row flex-center child-borders child-shadows"},F={class:"form-group"},H=s("label",null,"Error message",-1),M={key:0,class:"progress"},L={key:1},P={class:"col-2 col border-dashed ml-2"},E={class:"form-group h-100"},S=s("label",{for:"paperInputs1"},"Highlights",-1),U=["value"],O={class:"row flex-center"},V={class:"col-8 col"},B={class:"modal"},R=s("label",{class:"modal-bg",for:"modal-1"},null,-1),z={class:"modal-body"},A=s("label",{class:"btn-close",for:"modal-1"},"X",-1),N=s("h4",{class:"modal-title"},"Here's your link...",-1),I=["value"];function j(o,e,a,K,l,r){const p=m("Layout");return i(),f(p,null,{default:v(()=>[s("div",T,[s("div",{class:h("col-6 col border-dashed "+r.dropClass),onDrop:e[3]||(e[3]=(...t)=>r.handleFileDrop&&r.handleFileDrop(...t)),onDragover:e[4]||(e[4]=(...t)=>r.handleFileDragOver&&r.handleFileDragOver(...t)),onDragleave:e[5]||(e[5]=(...t)=>r.handleFileDragLeave&&r.handleFileDragLeave(...t))},[s("div",F,[H,g(s("textarea",{ref:"log",class:"input-block no-resize p-5","onUpdate:modelValue":e[0]||(e[0]=t=>l.form.log=t),rows:"15",onSelect:e[1]||(e[1]=t=>r.selectHighlight()),onInput:e[2]||(e[2]=t=>r.handleTextareaChange()),placeholder:"Drop or paste image to automatically read error message or just type something..."},null,544),[[b,l.form.log]])]),l.uploading?(i(),n("div",M,[s("div",{class:h("bar striped w-"+l.uploadProgress),role:"progressbar"},u(l.uploadProgress)+"% ",3)])):d("",!0),l.uploading?(i(),n("div",L,"OCR processing...")):d("",!0)],34),s("div",P,[s("div",E,[S,(i(!0),n(w,null,D(l.form.highlights,t=>(i(),n("input",{class:"input-block",value:t,type:"text"},null,8,U))),256))]),l.form.highlights.length>0?(i(),n("button",{key:0,class:"btn-block btn-small btn-danger-outline",onClick:e[6]||(e[6]=t=>r.clearHighlights())},"Clear highlights")):d("",!0)])]),s("div",O,[s("div",V,[s("button",{class:"btn-block btn-secondary",onClick:e[7]||(e[7]=t=>r.submit()),onMouseover:e[8]||(e[8]=t=>l.saveHint="(Ctrl + S would also work)"),onMouseout:e[9]||(e[9]=t=>l.saveHint="")},[y("Create link "),s("small",null,u(l.saveHint),1)],32)])]),g(s("input",{class:"modal-state",id:"modal-1","onUpdate:modelValue":e[10]||(e[10]=t=>l.showModal=t),type:"checkbox"},null,512),[[k,l.showModal]]),s("div",B,[R,s("div",z,[A,N,s("input",{class:"input-block",value:r.viewUrl,disabled:"",type:"text",size:"50"},null,8,I),s("button",{class:"btn-block btn-primary mt-2",onClick:e[11]||(e[11]=t=>r.copyToClipboard())},"Copy to clipboard")])])]),_:1})}const G=C(x,[["render",j]]);export{G as default};
