import{T as u,r as p,o as a,c as m,w as f,a as s,n as h,b as g,v,d as n,t as b,e as d,f as _,F as D,g as w}from"./app-fde13884.js";import{_ as y,L as C}from"./Layout-cad93bd2.js";const k={components:{Layout:C},data(){return{form:u({log:null,highlights:[]}),random:null,showModal:!1,uploading:!1,uploadProgress:0,isDragging:!1}},methods:{init(){},submit(){this.form.put("/",{onSuccess:t=>{this.random=t.props.random,this.showModal=!0,this.reset()},onError:()=>{alert("Error...")}})},selectHighlight(){const t=this.$refs.log,e=this.form.log.slice(t.selectionStart,t.selectionEnd);this.form.highlights.includes(e)||this.form.highlights.push(e)},copyToClipboard(){copyToClipboard(this.viewUrl)},clearHighlights(){window.getSelection().removeAllRanges(),this.form.highlights=[]},reset(){this.form.reset()},ocr(t){t.preventDefault(),this.isDragging=!1,this.uploading=!0;let e=new FormData;for(const r of t.dataTransfer.files)e.append(r.name,r);axios.post("/ocr",e,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:r=>{this.uploadProgress=Math.ceil(r.loaded/r.total*100/5)*5}}).then(r=>{this.form.log=r.data.text}).catch(r=>{alert("Error during OCR processing...")}).finally(r=>{this.uploading=!1})},handleFileDragOver(t){t.preventDefault(),this.isDragging=!0},handleFileDragLeave(t){t.preventDefault(),this.isDragging=!1}},computed:{viewUrl(){return window.location+this.random},dropClass(){return this.isDragging?"border-success":""}},mounted(){this.init(),emitter.on("keypress-ctrl-s",t=>{t.preventDefault(),this.submit()})},watch:{}},x={class:"row flex-center child-borders child-shadows"},F={class:"form-group"},L=s("label",null,"Error message",-1),M={key:0,class:"progress"},T={key:1},E={class:"col-2 col border-dashed ml-2"},H={class:"form-group h-100"},U=s("label",{for:"paperInputs1"},"Highlights",-1),O=["value"],P={class:"row flex-center"},S={class:"col-8 col"},B={class:"modal"},V=s("label",{class:"modal-bg",for:"modal-1"},null,-1),z={class:"modal-body"},R=s("label",{class:"btn-close",for:"modal-1"},"X",-1),N=s("h4",{class:"modal-title"},"Here's your link...",-1),A=["value"];function I(t,e,r,X,i,l){const c=p("Layout");return a(),m(c,null,{default:f(()=>[s("div",x,[s("div",{class:h("col-6 col border-dashed "+l.dropClass),onDrop:e[2]||(e[2]=(...o)=>l.ocr&&l.ocr(...o)),onDragover:e[3]||(e[3]=(...o)=>l.handleFileDragOver&&l.handleFileDragOver(...o)),onDragleave:e[4]||(e[4]=(...o)=>l.handleFileDragLeave&&l.handleFileDragLeave(...o))},[s("div",F,[L,g(s("textarea",{ref:"log",class:"input-block no-resize p-5","onUpdate:modelValue":e[0]||(e[0]=o=>i.form.log=o),rows:"15",onSelect:e[1]||(e[1]=o=>l.selectHighlight())},null,544),[[v,i.form.log]])]),i.uploading?(a(),n("div",M,[s("div",{class:h("bar striped w-"+i.uploadProgress),role:"progressbar"},b(i.uploadProgress)+"% ",3)])):d("",!0),i.uploading?(a(),n("div",T,"OCR processing...")):d("",!0)],34),s("div",E,[s("div",H,[U,(a(!0),n(D,null,_(i.form.highlights,o=>(a(),n("input",{class:"input-block",value:o,type:"text"},null,8,O))),256))]),i.form.highlights.length>0?(a(),n("button",{key:0,class:"btn-block btn-small btn-danger-outline",onClick:e[5]||(e[5]=o=>l.clearHighlights())},"Clear highlights")):d("",!0)])]),s("div",P,[s("div",S,[s("button",{class:"btn-block btn-secondary",onClick:e[6]||(e[6]=o=>l.submit())},"Create")])]),g(s("input",{class:"modal-state",id:"modal-1","onUpdate:modelValue":e[7]||(e[7]=o=>i.showModal=o),type:"checkbox"},null,512),[[w,i.showModal]]),s("div",B,[V,s("div",z,[R,N,s("input",{class:"input-block",value:l.viewUrl,disabled:"",type:"text",size:"50"},null,8,A),s("button",{class:"btn-block btn-primary mt-2",onClick:e[8]||(e[8]=o=>l.copyToClipboard())},"Copy to clipboard")])])]),_:1})}const G=y(k,[["render",I]]);export{G as default};
